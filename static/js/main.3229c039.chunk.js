(this["webpackJsonp6-microbit"]=this["webpackJsonp6-microbit"]||[]).push([[0],{125:function(e,t){},148:function(e,t,n){e.exports=n(296)},153:function(e,t,n){},154:function(e,t,n){},293:function(e,t){},294:function(e,t){},296:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(34),c=n.n(r),o=(n(153),n(15)),s=n(16),l=n(17),u=n(18),h=n(30),p=n(19),m=(n(154),n(302)),d=n(301),f=n(312),b=n(44),v=(n(307),n(311));n(309);var E=n(306);Promise.delay=function(e){return new Promise((function(t,n){setTimeout((function(){t()}),e)}))};var y={requestType:"class",recipient:"interface",request:9,value:512,index:4},g={requestType:"class",recipient:"interface",request:1,value:256,index:4};function O(e){navigator.usb.requestDevice({filters:[{vendorId:3368,productId:516}]}).then((function(t){t.opened||function(e,t){var n="",a=new TextDecoder("utf-8"),i=/([^.:]*)\.*([^:]+|):(.*)/;function r(t){return function(){return e.controlTransferOut(y,t)}}e.open().then((function(){return e.selectConfiguration(1)})).then((function(){return e.claimInterface(4)})).then(r(Uint8Array.from([2,0]))).then(r(Uint8Array.from([17,128,150,152,0]))).then(r(Uint8Array.from([19,0]))).then(r(Uint8Array.from([130,0,194,1,0]))).then((function(){return t("connected",e,null),Promise.resolve()})).then((function r(){e.controlTransferOut(y,Uint8Array.from([131])).then((function(){return e.controlTransferIn(g,64)})).then((function(c){if("ok"!=c.status)return Promise.delay(500).then(r);var o=new Uint8Array(c.data.buffer);if(o.length<2)return Promise.delay(150).then(r);var s=o[1];if(0==s)return Promise.delay(150).then(r);for(var l=o.slice(2,2+s),u=a.decode(l),h=(n+=u).indexOf("\n");h>=0;){var p=n.slice(0,h),m=new Date,d=i.exec(p);if(d){var f=d[1],b=d[2],v=d[3],E="graph-event";isNaN(v)||(E="graph-data",v=parseFloat(v)),t(E,e,{time:m,graph:f,series:b,data:v})}else{t("console",e,{time:m,data:p})}h=(n=n.slice(h+1)).indexOf("\n")}return Promise.delay(20).then(r)})).catch((function(n){e.opened&&t("error",e,n),e.close(),t("disconnected",e,null)}))})).catch((function(n){return t("error",e,n)}))}(t,e)})).catch((function(){return e("connection failure",null,null)}))}function j(e){return i.a.createElement(E.a,{size:"big",onClick:function(t){O(e.onAddComplete)}},i.a.createElement(b.a,{name:"plus"}),"Add Micro:bit")}var k=n(305),C=n(310),w=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return this.props.isRunning?i.a.createElement(E.a,{icon:!0,labelPosition:"left",onClick:this.props.onClick,color:"red"},i.a.createElement(b.a,{name:"pause"}),"Pause"):i.a.createElement(E.a,{icon:!0,labelPosition:"left",onClick:this.props.onClick,color:"green",style:{width:"115.28px"}},i.a.createElement(b.a,{name:"play"}),"Play")}}]),t}(a.Component),x=n(137),A=n(89),D=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement(E.a,{icon:!0,labelPosition:"left",onClick:function(t){return function(e,t){var n={Sheets:{data:A.utils.json_to_sheet(e)},SheetNames:["data"]},a=A.write(n,{bookType:"csv",type:"array"}),i=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});x.saveAs(i,t+".csv")}(e.props.csvData,e.props.fileName)},color:"grey",style:{width:"115.28px"}},i.a.createElement(b.a,{name:"save"}),"Save")}}]),t}(a.Component);var L=function(e){return i.a.createElement(E.a,{size:"big",onClick:function(t){e.disconnectDevice(e.device)}},"Disconnect Device")},T=n(90),P=n.n(T),N=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(P.a,{options:this.props.options,series:this.props.series}),i.a.createElement(P.a,{options:this.props.optionsLine,series:this.props.seriesLine,type:"area",height:this.props.optionsLine.chart.height}))}}]),t}(a.Component),R=n(138),S=n.n(R),B=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement(d.a,{textAlign:"center"},i.a.createElement(f.a,{content:this.props.title,size:"huge",style:{color:"#FFF"}}))}}]),t}(a.Component),F=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(d.a,null,i.a.createElement(B,{title:this.props.title}),i.a.createElement(k.a,{definition:!0,textAlign:"center"},i.a.createElement(k.a.Body,null,i.a.createElement(k.a.Row,null,i.a.createElement(k.a.Cell,{width:2,verticalAlign:"top"},i.a.createElement(w,{isRunning:this.props.isRunning,onClick:this.props.playOnClick}),i.a.createElement(m.a,{hidden:!0}),i.a.createElement(D,{csvData:this.props.csvData,fileName:"microbit-usb-data-"+S()().format("MM-DD")}),i.a.createElement(m.a,{hidden:!0}),i.a.createElement(L,{device:this.props.device,disconnectDevice:this.props.disconnectDevice.bind(this)}),i.a.createElement(C.a,{size:"mini",style:{}},i.a.createElement(C.a.Value,null,i.a.createElement(b.a,{name:"clock outline"})," 0"),i.a.createElement(C.a.Label,null,"Time Elapsed"))),i.a.createElement(k.a.Cell,null,i.a.createElement(N,{options:this.props.options,series:this.props.series,optionsLine:this.props.optionsLine,seriesLine:this.props.seriesLine,height:this.props.height,areaHeight:this.props.areaHeight})))))),i.a.createElement(m.a,{hidden:!0}))}}]),t}(a.Component),U=n(303),M=n(304),I=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement(d.a,null,i.a.createElement(v.a,{style:{backgroundColor:"#252839"}},i.a.createElement(U.a,{position:"right"},i.a.createElement(M.a,null,i.a.createElement(v.a,{textAlign:"center"},i.a.createElement(C.a.Group,null,i.a.createElement(C.a,null,i.a.createElement(C.a.Value,null,i.a.createElement(b.a,{name:"usb"})," ",this.props.microbitsConnected),i.a.createElement(C.a.Label,null,"Microbits Connected"))))))))}}]),t}(a.Component),q=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).contextRef=Object(a.createRef)(),n.state={devices:{},isRunning:!1,microbitsConnected:0,graphs:[],options:{chart:{id:"chart2",type:"line",height:230,toolbar:{autoSelected:"pan",show:!1}},colors:["#546E7A"],stroke:{width:3},dataLabels:{enabled:!1},fill:{opacity:1},markers:{size:0},xaxis:{type:"date",categories:[]}},seriesLine:[{data:["2019-11-30T08:17:24.220Z","2019-12-30T08:17:24.220Z","2020-1-30T08:17:24.220Z"]}],optionsLine:{chart:{id:"chart1",height:130,type:"area",brush:{target:"chart2",enabled:!0},selection:{enabled:!0}},colors:["#008FFB"],fill:{type:"gradient",gradient:{opacityFrom:.91,opacityTo:.1}},xaxis:{type:"date",tooltip:{enabled:!1}},yaxis:{tickAmount:2}},seconds:0},n.microbitCallBack=n.microbitCallBack.bind(Object(h.a)(n)),n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"microbitCallBack",value:function(e,t,n){if("connected"===e){var a=this.state.devices;a[t.serialNumber]=t,this.setState({devices:a}),this.createGraph(t)}}},{key:"disconnectDevice",value:function(e){!function(e){e&&e.opened&&e.close()}(e);var t=this.state.devices,n=this.state.graphs;delete t[e.serialNumber],delete n[e.serialNumber],this.setState({graphs:n,devices:t,microbitsConnected:this.state.microbitsConnected-1})}},{key:"createGraph",value:function(e){if(void 0===this.state.graphs[e.serialNumber]){var t=this.state.graphs;t[e.serialNumber]={deviceSerial:e.serialNumber,title:"Micro:bit Graph "+e.vendorId,isRunning:!1,timeElapsed:0,series:[{data:[]}]},this.setState({graphs:t,microbitsConnected:this.state.microbitsConnected+1})}}},{key:"render",value:function(){var e=this,t=[2,5,6,3,8,9].map((function(e,t){return{key:t,value:e*e}})),n=this.state.graphs;return i.a.createElement("div",null,i.a.createElement(f.a,{as:"h2",icon:!0,inverted:!0,textAlign:"center"},i.a.createElement(b.a,{name:"line graph"}),"Micro: bit USB Grapher",i.a.createElement(f.a.Subheader,null,"Collect and graph data on one or more Micro: bits!")),i.a.createElement(m.a,null),i.a.createElement(I,{microbitsConnected:this.state.microbitsConnected,timeElapsed:this.state.timeElapsed}),i.a.createElement(d.a,null,i.a.createElement(j,{onAddComplete:this.microbitCallBack}),n&&Object.keys(n).map((function(a,r){return i.a.createElement("div",null,i.a.createElement(F,{device:e.state.devices[a],title:n[a].title,csvData:t,options:e.state.options,series:n[a].series,optionsLine:e.state.optionsLine,seriesLine:e.state.seriesLine,height:e.state.height,areaHeight:e.state.areaHeight,isRunning:n[a].isRunning,playOnClick:function(){n[a].isRunning=!0,e.setState({graphs:n})},disconnectDevice:e.disconnectDevice.bind(e)}))}))))}}]),t}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(i.a.createElement(q,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[148,1,2]]]);
//# sourceMappingURL=main.3229c039.chunk.js.map