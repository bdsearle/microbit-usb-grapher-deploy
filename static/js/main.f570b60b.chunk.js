(this["webpackJsonp6-microbit"]=this["webpackJsonp6-microbit"]||[]).push([[0],{135:function(e,t,a){e.exports=a.p+"static/media/MicrobitWebUSBGrapher-Instructions.3fe99ffe.pdf"},178:function(e,t){},227:function(e,t,a){e.exports=a(401)},232:function(e,t,a){},233:function(e,t,a){},330:function(e,t){},331:function(e,t){},390:function(e,t,a){},401:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(49),c=a.n(r),s=(a(232),a(197)),l=a(218),o=a(16),u=a(17),m=a(18),d=a(19),h=a(27),p=a(20),v=(a(233),a(409)),b=a(417),f=a(419),E=a(52),g=a(137);Promise.delay=function(e){return new Promise((function(t,a){setTimeout((function(){t()}),e)}))};var y={requestType:"class",recipient:"interface",request:9,value:512,index:4},C={requestType:"class",recipient:"interface",request:1,value:256,index:4};function k(e){navigator.usb.requestDevice({filters:[{vendorId:3368,productId:516}]}).then((function(t){t.opened||function(e,t){var a="",n=new TextDecoder("utf-8"),i=/([^.:]*)\.*([^:]+|):(.*)/;function r(t){return function(){return e.controlTransferOut(y,t)}}e.open().then((function(){return e.selectConfiguration(1)})).then((function(){return e.claimInterface(4)})).then(r(Uint8Array.from([2,0]))).then(r(Uint8Array.from([17,128,150,152,0]))).then(r(Uint8Array.from([19,0]))).then(r(Uint8Array.from([130,0,194,1,0]))).then((function(){return t("connected",e,null),Promise.resolve()})).then((function r(){e.controlTransferOut(y,Uint8Array.from([131])).then((function(){return e.controlTransferIn(C,64)})).then((function(c){if("ok"!==c.status)return Promise.delay(500).then(r);var s=new Uint8Array(c.data.buffer);if(s.length<2)return Promise.delay(150).then(r);var l=s[1];if(0===l)return Promise.delay(150).then(r);for(var o=s.slice(2,2+l),u=n.decode(o),m=(a+=u).indexOf("\n");m>=0;){var d=a.slice(0,m),h=new Date,p=i.exec(d);if(p){var v=p[1],b=p[2],f=p[3],E="graph-event";isNaN(f)||(E="graph-data",f=parseFloat(f)),t(E,e,{time:h,graph:v,series:b,data:f})}else{t("console",e,{time:h,data:d})}m=(a=a.slice(m+1)).indexOf("\n")}return Promise.delay(20).then(r)})).catch((function(a){e.opened&&t("error",e,a),e.close(),t("disconnected",e,null)}))})).catch((function(a){return t("error",e,a)}))}(t,e)})).catch((function(){return e("connection failure",null,null)}))}function O(e){return i.a.createElement(g.a,{size:"big",onClick:function(t){k(e.onAddComplete)}},i.a.createElement(E.a,{name:"plus"}),"Add Micro:bit")}var S=a(414),j=a(411),w=a(416),x=function(e){function t(){return Object(o.a)(this,t),Object(m.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return this.props.isRunning?i.a.createElement(g.a,{icon:!0,labelPosition:"left",onClick:this.props.onClick,color:"red"},i.a.createElement(E.a,{name:"pause"}),"Pause"):i.a.createElement(g.a,{icon:!0,labelPosition:"left",onClick:this.props.onClick,color:"green",style:{width:"115.28px"}},i.a.createElement(E.a,{name:"play"}),"Play")}}]),t}(n.Component),D=a(203),A=a(132),N=function(e){function t(){return Object(o.a)(this,t),Object(m.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement(g.a,{icon:!0,labelPosition:"left",onClick:function(t){return function(e,t){var a={Sheets:{data:A.utils.json_to_sheet(e)},SheetNames:["data"]},n=A.write(a,{bookType:"csv",type:"array"}),i=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});D.saveAs(i,t+".csv")}(e.props.csvData,e.props.fileName)},color:"grey",style:{width:"115.28px"}},i.a.createElement(E.a,{name:"save"}),"Save")}}]),t}(n.Component),M=a(408),T=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(i)))).disconnectMicro=function(){a.props.disconnectDevice(a.props.device)},a.state={open:!1},a.open=function(){return a.setState({open:!0})},a.close=function(){return a.setState({open:!1})},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(g.a,{size:"big",onClick:this.open},"Disconnect Device"),i.a.createElement(M.a,{header:"Confirm Disconnecting Micro:bit",content:"Are you sure you want to disconnect this Micro:bit device?",confirmButton:"Yes",open:this.state.open,onCancel:this.close,onConfirm:function(t){e.disconnectMicro(),e.close()}}))}}]),t}(n.Component),L=a(134),B=a.n(L),I=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).state={series:[{data:[]}],options:{chart:{id:"chart2",type:"line",height:230,toolbar:{autoSelected:"pan",show:!1}},colors:["#546E7A"],stroke:{width:3},dataLabels:{enabled:!1},fill:{opacity:1},markers:{size:0},xaxis:{type:"date",categories:[]}},seriesLine:[{data:[]}],optionsLine:{chart:{id:"chart1",height:130,type:"area",brush:{target:"chart2",enabled:!0},selection:{enabled:!0}},colors:["#008FFB"],fill:{type:"gradient",gradient:{opacityFrom:.91,opacityTo:.1}},xaxis:{type:"date",tooltip:{enabled:!1}},yaxis:{tickAmount:2}},seconds:0},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"tick",value:function(){this.props.runRealtimeData&&void 0!==this.props.series[0].data[0]&&(this.setState((function(e){return{seconds:e.seconds+1}})),this.props.setSeconds(this.state.seconds))}},{key:"pushRealtimeData",value:function(){null!=this.state.series[0].data&&void 0!==this.state.series[0].data&&this.props.runRealtimeData&&void 0!==this.props.series[0].data[this.state.seconds]&&(this.setState({series:[{data:this.state.series[0].data.concat(this.props.series[0].data[this.state.seconds])}],seriesLine:[{data:this.state.series[0].data}],options:{xaxis:{type:"datetime",categories:this.state.options.xaxis.categories.push(this.state.seconds)}}}),this.props.setCSVData(this.state.series[0].data))}},{key:"componentDidMount",value:function(){var e=this;this.interval=setInterval((function(){return e.tick()}),1e3),this.interval=setInterval((function(){return e.pushRealtimeData()}),1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(B.a,{options:this.state.options,series:this.state.series}),i.a.createElement(B.a,{options:this.state.optionsLine,series:this.state.seriesLine,type:"area",height:130}))}}]),t}(i.a.Component),R=a(215),P=a.n(R),F=a(95),U=a(410),H=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(i)))).state={open:!1},a.show=function(){a.setState({open:!0})},a.close=function(){return a.setState({open:!1})},a.handleSubmit=function(){},a.handleChange=function(e,t){var n=t.value;return a.setState({value:n})},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state.open;return i.a.createElement(v.a,{textAlign:"center"},i.a.createElement(f.a,{size:"huge",style:{color:"#FFF"}},this.props.title,i.a.createElement(g.a,{animated:"vertical",style:{margin:"0 0 5px 15px"},onClick:this.show},i.a.createElement(g.a.Content,{hidden:!0},"Edit"),i.a.createElement(g.a.Content,{visible:!0},i.a.createElement(E.a,{fitted:!0,name:"pencil"})))),i.a.createElement(F.a,{onSubmit:this.handleSubmit(),size:"mini",closeOnDimmerClick:!1,open:e,onClose:this.close},i.a.createElement(F.a.Header,null,"Edit Title"),i.a.createElement(F.a.Content,null,i.a.createElement(U.a,{placeholder:"Edit",type:"text",name:"title",onChange:this.handleChange,style:{width:"100%"}})),i.a.createElement(F.a.Actions,null,i.a.createElement(g.a,{negative:!0,onClick:this.close},"Cancel"),i.a.createElement(g.a,{positive:!0,onClick:this.close,icon:"checkmark",labelPosition:"right",content:"Save",type:"submit"}))))}}]),t}(n.Component),V=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).state={seconds:0,csvData:[]},a.setSeconds=a.setSeconds.bind(Object(h.a)(a)),a.setCSVData=a.setCSVData.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"setSeconds",value:function(e){this.setState({seconds:e})}},{key:"setCSVData",value:function(e){var t=e.map((function(e,t){return{key:t+1,value:e}}));this.setState({csvData:t})}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(v.a,null,i.a.createElement(H,{title:this.props.title,handleSubmit:this.props.handleSubmit}),i.a.createElement(S.a,{definition:!0,textAlign:"center"},i.a.createElement(S.a.Body,null,i.a.createElement(S.a.Row,null,i.a.createElement(S.a.Cell,{width:2,verticalAlign:"top"},i.a.createElement(x,{isRunning:this.props.isRunning,onClick:this.props.playOnClick}),i.a.createElement(j.a,{hidden:!0}),i.a.createElement(N,{csvData:this.state.csvData,fileName:"microbit-usb-data-"+P()().format("MM-DD")}),i.a.createElement(j.a,{hidden:!0}),i.a.createElement(T,{device:this.props.device,disconnectDevice:this.props.disconnectDevice.bind(this)}),i.a.createElement(w.a,{size:"mini",style:{}},i.a.createElement(w.a.Value,null,i.a.createElement(E.a,{name:"clock outline"})," ",this.state.seconds),i.a.createElement(w.a.Label,null,"Time Elapsed"))),i.a.createElement(S.a.Cell,null,i.a.createElement(I,{series:this.props.series,runRealtimeData:this.props.isRunning,setCSVData:this.setCSVData,setSeconds:this.setSeconds})))))),i.a.createElement(j.a,{hidden:!0}))}}]),t}(n.Component),G=a(420),q=a(412),z=a(413),W=function(e){function t(){return Object(o.a)(this,t),Object(m.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return i.a.createElement(v.a,null,i.a.createElement(G.a,{style:{backgroundColor:"#252839"}},i.a.createElement(q.a,{position:"right"},i.a.createElement(z.a,null,i.a.createElement(G.a,{textAlign:"center"},i.a.createElement(w.a.Group,null,i.a.createElement(w.a,null,i.a.createElement(w.a.Value,null,i.a.createElement(E.a,{name:"usb"})," ",this.props.microbitsConnected),i.a.createElement(w.a.Label,null,"Microbits Connected"))))))))}}]),t}(n.Component),_=a(415),J=a(135),Q=a.n(J),Y=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(i)))).state={open:!1,activeIndex:-1},a.closeConfigShow=function(e,t){return function(){a.setState({closeOnEscape:e,closeOnDimmerClick:t,open:!0})}},a.close=function(){return a.setState({open:!1})},a.handleClick=function(e,t){var n=t.index,i=a.state.activeIndex===n?-1:n;a.setState({activeIndex:i})},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state,t=e.open,a=e.closeOnEscape,n=e.closeOnDimmerClick,r=e.activeIndex;return i.a.createElement("div",null,i.a.createElement(g.a,{onClick:this.closeConfigShow(!0,!1),icon:!0,labelPosition:"left",color:"blue"},i.a.createElement(E.a,{name:"question circle outline"}),"Help"),i.a.createElement(F.a,{open:t,closeOnEscape:a,closeOnDimmerClick:n,onClose:this.close,closeIcon:!0},i.a.createElement(F.a.Header,{style:{color:"#FFF",backgroundColor:"#252839"}},"Micro:bit and Application Help"),i.a.createElement(F.a.Content,null,i.a.createElement(f.a,null,"Instructions:"," ",i.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:Q.a},"Click to Download PDF")),i.a.createElement(j.a,null),i.a.createElement(f.a,null,"Frequently Asked Questions (FAQ):"),i.a.createElement(_.a,{styled:!0,fluid:!0},i.a.createElement(_.a.Title,{active:0===r,index:0,onClick:this.handleClick},i.a.createElement(E.a,{name:"dropdown"}),"How to use the Micro:bit WebUSB Grapher?"),i.a.createElement(_.a.Content,{active:0===r},i.a.createElement("iframe",{src:Q.a,height:"900",width:"100%"})),i.a.createElement(_.a.Title,{active:1===r,index:1,onClick:this.handleClick},i.a.createElement(E.a,{name:"dropdown"}),"How to pair a Micro:bit device?"),i.a.createElement(_.a.Content,{active:1===r},i.a.createElement("div",{class:"ui grid stackable"},i.a.createElement("div",{class:"column five wide firmware"},i.a.createElement("strong",{class:"ui small"},"You must have version 0249 or above of the firmware"),i.a.createElement("div",{class:"image"},i.a.createElement("img",{class:"ui image",src:"./images/firmware.png"})),i.a.createElement("a",{href:"https://makecode.microbit.org/device/usb/webusb/troubleshoot",target:"_blank",rel:"noopener noreferrer"},"Check your firmware version here and update if needed")),i.a.createElement("div",{class:"column eleven wide instructions"},i.a.createElement("div",{class:"ui grid"},i.a.createElement("div",{class:"row"},i.a.createElement("div",{class:"column"},i.a.createElement("div",{class:"ui two column grid padded"},i.a.createElement("div",{class:"column"},i.a.createElement("div",{class:"ui"},i.a.createElement("div",{class:"image"},i.a.createElement("img",{class:"ui medium rounded image",src:"./images/connect.png"})),i.a.createElement("div",{class:"content"},i.a.createElement("div",{class:"description"},i.a.createElement("span",{class:"ui purple circular label"},"1"),i.a.createElement("strong",null,"Connect the micro:bit to your computer with a USB cable"),i.a.createElement("br",null),i.a.createElement("span",{class:"ui small"},"Use the microUSB port on the top of the micro:bit"))))),i.a.createElement("div",{class:"column"},i.a.createElement("div",{class:"ui"},i.a.createElement("div",{class:"image"},i.a.createElement("img",{class:"ui medium rounded image",src:"./images/pair.png"})),i.a.createElement("div",{class:"content"},i.a.createElement("div",{class:"description"},i.a.createElement("span",{class:"ui purple circular label"},"2"),i.a.createElement("strong",null,"Pair your micro:bit"),i.a.createElement("br",null),i.a.createElement("span",{class:"ui small"},"Click 'Pair device' below and select BBC micro:bit CMSIS-DAP or DAPLink CMSIS-DAP from the list")))))))))))),i.a.createElement(_.a.Title,{active:2===r,index:2,onClick:this.handleClick},i.a.createElement(E.a,{name:"dropdown"}),"How to program your Micro:bit?"),i.a.createElement(_.a.Content,{active:2===r},i.a.createElement("div",{class:"ui two column grid padded"},i.a.createElement("div",{class:"column"},i.a.createElement("div",{class:"ui"},i.a.createElement("div",{class:"image"},i.a.createElement("img",{class:"ui medium rounded image",src:"./images/connect.png"})),i.a.createElement("div",{class:"content"},i.a.createElement("div",{class:"description"},i.a.createElement("span",{class:"ui purple circular label"},"1"),i.a.createElement("strong",null,"Connect the micro:bit to your computer with a USB cable"),i.a.createElement("br",null),i.a.createElement("span",{class:"ui small"},"Use the microUSB port on the top of the micro:bit"))))),i.a.createElement("div",{class:"column"},i.a.createElement("div",{class:"ui"},i.a.createElement("div",{class:"image"},i.a.createElement("img",{class:"ui medium rounded image",src:"./images/transfer.png"})),i.a.createElement("div",{class:"content"},i.a.createElement("div",{class:"description"},i.a.createElement("span",{class:"ui purple circular label"},"2"),i.a.createElement("strong",null,"Move the .hex file to the micro:bit"),i.a.createElement("br",null),i.a.createElement("span",{class:"ui small"},"Locate the downloaded .hex file and drag it to the MICROBIT drive")))))))))))}}]),t}(n.Component),$=(a(390),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).handleItemClick=function(e,t){var n=t.name;return a.setState({activeTab:n})},a.contextRef=Object(n.createRef)(),a.state={devices:{},isRunning:!1,microbitsConnected:0,graphs:[],seconds:0,activeTab:"Microbit Graph 1"},a.microbitCallBack=a.microbitCallBack.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"convertLetterToNumber",value:function(e){for(var t=0,a=e.length,n=0;n<a;n++)t+=(e.charCodeAt(n)-64)*Math.pow(26,a-n-1);return t}},{key:"microbitCallBack",value:function(e,t,a){if("connected"===e){var n=this.state.devices;n[t.serialNumber]=t,this.setState({devices:n}),this.createGraph(t)}var i=this.state.graphs,r=a;if(void 0!==t&&null!==t&&void 0!==t.serialNumber&&null!==t.serialNumber&&void 0!==i[t.serialNumber]&&null!==i[t.serialNumber]&&void 0!==i[t.serialNumber].series&&null!==i[t.serialNumber].series&&null!==r&&void 0!==r&&void 0!==r.data&&void 0!==r.data){var c=i[t.serialNumber],o=i[t.serialNumber].series[0];isNaN(r.data)&&(r.data=this.convertLetterToNumber(r.data)),r.data=Math.round(10*r.data)/10,o.data.push(r.data.toString());var u=Object(l.a)(i);u[t.serialNumber]=Object(s.a)({},u[t.serialNumber],{deviceSerial:c.deviceSerial,title:c.title,isRunning:c.isRunning,timeElapsed:c.timeElapsed,series:[o],options:c.options,seriesLine:c.seriesLine,optionsLine:c.optionsLine}),this.setState({graphs:u})}}},{key:"disconnectDevice",value:function(e){!function(e){e&&e.opened&&e.close()}(e);var t=this.state.devices,a=this.state.graphs;delete t[e.serialNumber],delete a[e.serialNumber],this.setState({graphs:a,devices:t,microbitsConnected:this.state.microbitsConnected-1})}},{key:"createGraph",value:function(e){if(void 0===this.state.graphs[e.serialNumber]){var t=this.state.graphs;t[e.serialNumber]={deviceSerial:e.serialNumber,title:"Microbit Graph "+(this.state.microbitsConnected+1),isRunning:!1,timeElapsed:0,series:[{data:[]}],options:{chart:{id:"chart2",type:"line",height:230,toolbar:{autoSelected:"pan",show:!1}},colors:["#546E7A"],stroke:{width:3},dataLabels:{enabled:!1},fill:{opacity:1},markers:{size:0},xaxis:{type:"date",categories:[]}},seriesLine:[{data:[]}],optionsLine:{chart:{id:"chart1",height:130,type:"area",brush:{target:"chart2",enabled:!0},selection:{enabled:!0}},colors:["#008FFB"],fill:{type:"gradient",gradient:{opacityFrom:.91,opacityTo:.1}},xaxis:{type:"date",tooltip:{enabled:!1}},yaxis:{tickAmount:1}}},this.setState({graphs:t,microbitsConnected:this.state.microbitsConnected+1})}}},{key:"render",value:function(){var e=this,t=this.state.graphs,a=this.state.activeTab;return i.a.createElement("div",null,i.a.createElement(f.a,{as:"h2",icon:!0,inverted:!0,textAlign:"center"},i.a.createElement(E.a,{name:"line graph"}),"Micro: bit USB Grapher",i.a.createElement(f.a.Subheader,null,"Collect and graph data on one or more Micro: bits!")),i.a.createElement(v.a,{textAlign:"right",style:{marginBottom:"-46px"}},i.a.createElement(Y,null)),i.a.createElement(v.a,{textAlign:"left"},i.a.createElement(O,{onAddComplete:this.microbitCallBack})),i.a.createElement(v.a,{textAlign:"left",style:{marginTop:"10px"}},i.a.createElement(b.a,{attached:"top",id:"tabView",tabular:!0},Object.keys(t).map((function(n,r){return i.a.createElement(b.a.Item,{name:t[n].title,active:a===t[n].title,onClick:e.handleItemClick})})))),i.a.createElement(W,{microbitsConnected:this.state.microbitsConnected,timeElapsed:this.state.timeElapsed}),i.a.createElement(v.a,null,Object.keys(t).map((function(a,n){return e.state.activeTab===t[a].title&&t[a].title&&t[a].options&&t[a].series?i.a.createElement("div",null,i.a.createElement(V,{device:e.state.devices[a],title:t[a].title,options:t[a].options,series:t[a].series,optionsLine:t[a].optionsLine,seriesLine:t[a].seriesLine,height:t[a].height,areaHeight:t[a].areaHeight,isRunning:t[a].isRunning,graphs:t,key:a,setState:e.setState,playOnClick:function(){var t=Object.assign(e.state.graphs);t[a].isRunning=!t[a].isRunning,e.setState({graphs:t})},disconnectDevice:e.disconnectDevice.bind(e)})):i.a.createElement("div",null)}))))}}]),t}(i.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(i.a.createElement($,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[227,1,2]]]);
//# sourceMappingURL=main.f570b60b.chunk.js.map